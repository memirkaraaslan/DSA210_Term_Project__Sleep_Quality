import pandas as pd

# Load the Excel file
file_path = 'path_to_your_excel_file.xlsx'  # Update this to the actual file path
excel_data = pd.ExcelFile(file_path)

# Read the sheets
daily_activity = pd.read_excel(excel_data, sheet_name='Daily Activity Parameters')
additional_params = pd.read_excel(excel_data, sheet_name='Additional Parameters')
sleep_quality = pd.read_excel(excel_data, sheet_name='Sleep Quality Parameters')

# Ensure the date columns are in datetime format
daily_activity['Date'] = pd.to_datetime(daily_activity['Date'], errors='coerce')
additional_params['Date'] = pd.to_datetime(additional_params['Date'], errors='coerce')
sleep_quality['Date'] = pd.to_datetime(sleep_quality['Date'], errors='coerce')

# Merge the sheets on the "Date" column
merged_data = pd.merge(daily_activity, additional_params, on='Date', how='outer')
merged_data = pd.merge(merged_data, sleep_quality, on='Date', how='outer')

# Save the merged dataset
merged_data.to_excel('merged_data.xlsx', index=False)

print("Merged data saved as 'merged_data.xlsx'")
